---
name: health-dashboard
description: >
  Use when checking project health, code quality, dependency status,
  documentation freshness, or git health. Invoked via /cwe:quality health
  or PROACTIVELY at session start for status overview.
---

# Health Dashboard

Project health at a glance. Combines code quality, dependencies, documentation, git, and security metrics.

## Invocation

- `/cwe:quality health` — full dashboard
- Session start — abbreviated summary (idea count, uncommitted changes, version)

## Dashboard Sections

### 1. Code Quality

```bash
# Test coverage (detect test runner)
npm test -- --coverage 2>/dev/null    # Node.js
pytest --cov 2>/dev/null              # Python
cargo test 2>/dev/null                # Rust
go test -cover ./... 2>/dev/null      # Go
```

| Metric | How to Measure | Target |
|--------|---------------|--------|
| Test coverage | Test runner with --coverage flag | >80% |
| Complexity | Count functions >50 lines | avg <10 cyclomatic |
| TODO/FIXME count | `grep -r "TODO\|FIXME" src/` | Track trend |
| Type coverage | tsconfig strict, mypy, etc. | >90% |

### 2. Dependencies

```bash
# Outdated packages
npm outdated 2>/dev/null              # Node.js
pip list --outdated 2>/dev/null       # Python

# Vulnerability scan
npm audit 2>/dev/null                 # Node.js
pip-audit 2>/dev/null                 # Python
cargo audit 2>/dev/null               # Rust
```

| Metric | How to Measure | Target |
|--------|---------------|--------|
| Total deps | Package manifest | Track count |
| Outdated (minor) | Package manager outdated | <5 |
| Outdated (major) | Package manager outdated | 0 |
| Vulnerabilities | Audit tool | 0 |
| License issues | License checker | 0 |

### 3. Documentation

Uses `project-docs` skill for freshness check:

| Check | Method | Target |
|-------|--------|--------|
| README current | VERSION match | current |
| ARCHITECTURE.md | Component list match | current |
| API.md | Endpoint count match | current |
| CHANGELOG | Latest version match | current |
| ADRs | Count + no "Proposed" stale >30d | all resolved |

### 4. Git Health

```bash
git status --porcelain          # Uncommitted changes
git log --oneline -1            # Last commit
git branch --show-current       # Current branch
git log --format='%s' -20       # Recent commit messages for CC check
```

| Metric | How to Measure | Target |
|--------|---------------|--------|
| Current branch | git branch | descriptive name |
| Uncommitted changes | git status | <10 files |
| Last commit | git log -1 | <24h ago |
| Conventional commits | Parse last 20 messages | >95% |
| Unpushed commits | git log @{u}..HEAD | <5 |

### 5. Security

| Check | Method | Target |
|-------|--------|--------|
| .gitignore complete | Check required entries | all present |
| Secrets scan | Run safety-gate patterns on codebase | 0 findings |
| Last audit | Check daily logs (memory/YYYY-MM-DD.md) for security agent run | <7 days |
| Dependencies | npm audit / pip-audit | 0 vulnerabilities |

## Output Format

```markdown
## Project Health: <project-name> v<VERSION>

### Code Quality
- Test Coverage: XX% (trend)
- Complexity: X.X avg (target: <10)
- TODO/FIXME count: X (trend)

### Dependencies
- Total: X (Y dev)
- Outdated: X minor, X major
- Vulnerable: X
- License issues: X

### Documentation
- README: current | STALE
- ARCHITECTURE.md: current | STALE
- API.md: current | STALE | N/A
- CHANGELOG: current | STALE

### Git Health
- Branch: <branch-name>
- Uncommitted: X files
- Last commit: Xh ago
- Conventional commits: XX%

### Security
- .gitignore: complete | incomplete
- Secrets scan: clean | X findings
- Last audit: X days ago
```

## Health Score

Calculate an overall score (0-100):

| Category | Weight | Scoring |
|----------|--------|---------|
| Code Quality | 25% | Coverage >80% = full, -2 per % below |
| Dependencies | 20% | 0 vulnerable = full, -10 per vuln |
| Documentation | 20% | All current = full, -5 per stale doc |
| Git Health | 20% | CC >95% + clean tree = full |
| Security | 15% | Clean scan + complete .gitignore = full |

Display as: `Health Score: 87/100 (Good)`

| Score | Rating |
|-------|--------|
| 90-100 | Excellent |
| 75-89 | Good |
| 60-74 | Needs Attention |
| <60 | Critical |

## CODEOWNERS Generation

Auto-generate `CODEOWNERS` from git history:

```bash
# For each top-level directory, find most active contributors
git log --format='%aN' -- <path> | sort | uniq -c | sort -rn | head -3
```

Output GitHub-compatible `CODEOWNERS` format:
```
# Auto-generated by CWE health-dashboard
/src/auth/    @developer1 @developer2
/src/api/     @developer1
/docs/        @developer3
```
